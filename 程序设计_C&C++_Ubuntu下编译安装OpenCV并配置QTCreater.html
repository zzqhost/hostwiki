<html>
  <head>
    <title>Ubuntu下编译安装OpenCV并配置QTCreater</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="Stylesheet" type="text/css" href="cssandjs/style.css" />
</head>


<body>


<div id="container">
    <div id="header">张志强的wiki</div>
    <br class="clearfloat" />
    <div id="content">
<p>
<a href="index.html">首页</a>
</p>
<h1 id="toc_1"> Ubuntu下编译安装OpenCV并配置QTCreater</h1>
<div class="toc">
<ul>
<li><a href="#toc_1"> Ubuntu下编译安装OpenCV并配置QTCreater</a>
<ul>
<li><a href="#toc_1.1">1. 编译安装</a>
<li><a href="#toc_1.2">2. 配置QTCreater并运行例程测试</a>
</ul>
</ul>
</div>

<h2 id="toc_1.1">1. 编译安装</h2>
<ul>
<li>
首先在终端运行下列命令进行必要的编译环境安装

<ul>
<li>
$ sudo apt-get install build-essential libgtk2.0-dev libavcodec-dev libavformat-dev libjpeg62-dev libtiff4-dev cmake libswscale-dev libjasper-dev

</ul>
</ul>

<ul>
<li>
下载相应的版本到电脑里面，这里我们以下载OpenCV-2.4.3为例

<li>
解压并配置编译环境

<ul>
<li>
解压 OpenCV-2.3.1.tar.bz2

<li>
$ cd OpenCV-2.3.1

<li>
$ mkdir build 

<li>
$ cd build

<li>
$ cmake ..  (此处为cmake空格后面两个点,即上级目录, 你懂的....)

</ul>
<li>
编译安装

<ul>
<li>
make

<li>
sudo make install

</ul>
<li>
安装后的路径为: (可以在cmake那一步观察到)

<ul>
<li>
/usr/local/include/opencv/

<li>
/usr/local/include/opencv2/

<li>
/usr/local/lib/

</ul>
</ul>

<ul>
<li>
配置必要的库

<ul>
<li>
sudo gedit /etc/ld.so.conf.d/opencv.conf

<li>
添加这句命令到文件中，文件或许是空的，不影响.    /usr/local/lib/

</ul>
</ul>

<ul>
<li>
 运行此命令

<ul>
<li>
$ sudo ldconfig

</ul>
</ul>

<ul>
<li>
现在运行这条命令 sudo gedit /etc/bash.bashrc，添加下面两行到文件的末尾并保存。

<ol>
<li>
PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig

<li>
export PKG_CONFIG_PATH

</ol>
<li>
运行完毕后，需要注销一下系统，否则设置不会生效。

<li>
注销归来，opencv已经安装成功了

</ul>

<h2 id="toc_1.2">2. 配置QTCreater并运行例程测试</h2>
<ul>
<li>
将opencv库加入到qtcreator里

<ul>
<li>
$ sudo gedit /usr/share/qt4/mkspecs/default/qmake.conf

<li>
在文件内添加了下面两句：

<ol>
<li>
QMAKE_INCDIR = /usr/include/opencv 

<li>
QMAKE_LIBS = -lcvaux -lcv -lcxcore -lhighgui -lml

</ol>
</ul>
<li>
新建QT工程, 在这里我建了一个纯C++的工程取名为testopencv.

<li>
在testopencv.pro文件内添加：
<pre>
INCLUDEPATH += /usr/local/include/opencv
LIBS += \
/usr/local/lib/libopencv_core.so \
/usr/local/lib/libopencv_highgui.so \
/usr/local/lib/libopencv_ml.so
</pre>

</ul>

<ul>
<li>
输入以下代码,编译运行
<pre>

#include &lt;iostream&gt;

#include &lt;cv.h&gt;
#include &lt;highgui.h&gt;

using namespace std;

int main()
{
    IplImage *img = 0;
    img = cvLoadImage("/home/zzq/Desktop/test2.jpg", -1);
    cvNamedWindow("test", CV_WINDOW_NORMAL);
    cvShowImage("test", img);
    cvWaitKey(0);
    return 0;
}

</pre>

</ul>

<ul>
<li>
注: 在网上,有文章说可以把 pro文件中的配置放到 qmake.conf 中, 但是我试过,没有成功, 可能是放的配置文件不正确,或者是写法不正确, 有空了再研究一下.

</ul>
</div>
    <br class="clearfloat" />


    <div id="disqus_thread"></div>
    <script type="text/javascript" src="cssandjs/javascript/tongjianddisqus.js"></script>

    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    <div id="footer">
            zzqhost&nbsp;&copy;&nbsp;2012-2013&nbsp;
            <a href="http://www.zzqhost.com" target="_blank">www.zzqhost.com</a>
            <br>
            Generated by
            <a href="http://www.vim.org" target="_blank">Vim</a>
            &amp;
            <a href="http://code.google.com/p/vimwiki/" target="_blank">Vimwiki</a>
    </div>

</div>

</body>
</html>
